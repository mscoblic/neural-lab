# File: run_collision_heading.yaml
# Author: Mia Scoblic
# Date: 2025-08-15
# Description:
#     This file defines the training hyperparameters

  seed: 42                  # set random seed for reproducibility
  device: auto              # auto/cpu/cuda
  epochs: 200               # max number of times the entire training dataset is seen
  batch_size: 256            # number of samples processed together in each pass
  lr: 0.001                 # learning rate, small = low/stable, large = fast/risk of divergence
  val_split: 0.1            # validation split
  test_ratio: 0.1           # test split
  num_workers: 4            # option for parallel workers

  optimizer: adamw            # ["adamw","adam"]
  weight_decay: 0.0001        # default 0.0
  loss: mse                 # ["mse","huber","l1"]
  huber_beta: 0.5             # 0.1 if outputs in [0,1]; 0.5 if z-scored
  grad_clip: 1.0              # 0.0 disables
  scheduler:
    name: cosine              # ["none","cosine"]
    warmup_steps: 1000
  out_csv: collisions_pred_test.csv

  # option to stop early if validation loss stops improving withing a set number of epochs
  early_stopping:
    enabled: true
    patience: 15

  logging:
    run_name: ""            # auto-generated run folder unless specified
    out_dir: runs           # stored in trajectory_nn/runs
    save_every: 0           # how often to save checkpoints, 0 = only best, N = every N epochs too
